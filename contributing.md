# Contributing to Fingerprint Pro Server API SDK

## Structure

Most files in the project are autogenerated by [swagger-codegen](https://swagger.io/tools/swagger-codegen/) with `urllib3` library for python (default).

- [template](./template) - folder contains redefined templates of `swagger-codegen`. Original templates you can find in [swagger-codegen repo](https://github.com/swagger-api/swagger-codegen/tree/751e59df060b1c3ecf54921e104f2086dfa9f820/modules/swagger-codegen/src/main/resources/python).
- [docs](./docs) - generated documentation for models and [API Client](./docs/FingerprintApi.md).
- [fingerprint_pro_server_api_sdk](./fingerprint_pro_server_api_sdk) - API Client code is generated automatically.

## Code generation

You need `swagger-codegen` to run code generation. There are many ways described in the [readme](https://github.com/swagger-api/swagger-codegen).
In the project we use local jar file `swagger-codegen-cli.jar`.

You can just run `./generate.sh` script and it will do all the work.

To download fresh OpenAPI schema run `./sync.sh`

### Configuration

Project configuration is described in `config.json` file. To read about available parameters run the command below:

```shell
java -jar ./bin/swagger-codegen-cli.jar config-help -l python
```

### Testing the local source code of the SDK

To make requests using the local source code of the SDK:

1. Define your Secret API key, Visitor ID, Request ID and Region by creating a `.env` file at the root of the repository. (See [example](./.env.example)))
2. Run the following commands:

```shell
pip install -r requirements.txt
python run_checks.py
```

#### Test environment

You need to install `python` and `pip`.
Then you can run:

```shell
pip install -r requirements.txt
pip install -r test-requirements.txt
```

#### Running tests

```shell
pytest
```

### How to publish

The library is automatically released and published to PyPi on every push to the main branch if there are relevant changes using [semantic-release](https://github.com/semantic-release/semantic-release) with following plugins:
* [@semantic-release/commit-analyzer](https://github.com/semantic-release/commit-analyzer)
* [@semantic-release/release-notes-generator](https://github.com/semantic-release/release-notes-generator)
* [@semantic-release/changelog](https://github.com/semantic-release/changelog)
* [@semantic-release/exec](https://github.com/semantic-release/exec)
* [semantic-release-pypi](https://github.com/abichinger/semantic-release-pypi)
* [@semantic-release/github](https://github.com/semantic-release/github)

The workflow must be approved by one of the maintainers, first.

#### Pre-release flow

Pre-release will be created after merging pr to the `dev` branch and running the `release` workflow.

Python uses PEP 440 for versions format, so we convert a pre-release version from semver to PEP 440 in the `./generate.sh`.

new line to trigger prerelease
